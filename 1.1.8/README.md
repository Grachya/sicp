1.1.8  процедуры как абстрации типа "черный ящик"

![process image](https://assets.flocktory.com/uploads/clients/2125/d02c87eb-8101-461f-88af-f5c0de458955_process.jpg)

Внутри процедуры существуют формальные параметры.
Определение проедуры связывает **(bind)** свои формальыне параметры.

Процедура с вложенными определениями => **блочная структура**:

```lisp
(define (sqrt x)

  (define (good-enough? guess x)
    (< (abs (- (square guess) x)) 0.001))

  (define (improve guess x)
    (average guess (/ x guess)))

  (define (average z y)
    (/ (+ z y) 2))

  (define (sqrt-iter guess x)
    (if(good-enough? guess x)
      guess
      (sqrt-iter (improve guess x) x)))
      
  (sqrt-iter 1.0 x))
```

Все процедуры вложены в определение sqrt;
Эти процедуры локализованы, тк она внутри определения sqrt;
Тк x связана в определении, мы можем упростить внутренние определения, убрав из них x,
тем самым оставляя x свободной переменной; Такой порядок называется **лексической сферой действия**;

```lisp
(define (sqrt x)

  (define (good-enough? guess)
    (< (abs (- (square guess) x)) 0.001))

  (define (improve guess)
    (average guess (/ x guess)))

  (define (average z y)
    (/ (+ z y) 2))

  (define (sqrt-iter guess)
    (if(good-enough? guess x)
      guess
      (sqrt-iter (improve guess))))
      
  (sqrt-iter 1.0 x))
```
##1.2 Процедуры и порождаемые ими процессы.

Что бы стать классным специалистом нужно научиться представлять процессы генерируемые разлиыными видами процедур.

1.2.1 Линейная рекурсия и итерация

1) Вычисление факториала при условии что n! = n * (- n 1)!
```
(define (factorial n)
  (if (= n 1)
    1
    (* n (factorial (- n 1)))))
```

2) Выисление факториала со счетчиком:
```
(define (factorial n)
  (define (iter product counter)
    (if (> counter n)
    product
    (iter (* counter product) (+ counter 1))))
  (iter 1 1))
```

Рекурсия - построение цепочки отложенных операций

При вычислении n! (в операции №1) число операций (отложенных умножений) растет линейно с ростом n (пропорционально n) - **линейно рекурсивный процесс**;
При вычислении n! (в операции №2) процесс не растет и не сжимается. Мы лиш помним product counter и n. При этом число шагов линейно растет с увлениечем n - **линейно итеративный процесс**;

Итеративный процесс - это такой процесс состояние которого можно описать конечным числом переменных состояния
**Хвостовая рекурсия** - выполнение итеративного процесса используя фиксированные объем памяти, даже если он описывается рекурсивной процедурой.  Не у всех языков есть поддержка хвостовой рекурсии. в Scheme есть.
На языках C или Pascal используются специальные циклические конструкции do, repeat, untill, for, while - что по сути синтаксический сахар.

